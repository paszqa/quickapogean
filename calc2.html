<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Character Planner Skeleton</title>
    <style>
        @font-face {
            font-family: 'bedstead';
            src: url('bedstead-extracondensed.otf') format('truetype');
        }
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body, .stat-container, .stat-container > div, .levelnumber, .leveltitle {
            font-family: 'bedstead', Arial, sans-serif;
        }
        #planner-container {
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }
        .planner-upper {
            width: 100%;
            height: 50%;
            display: flex;
            flex-direction: row;
            border-bottom: 1px solid #000;
        }
        .planner-lower {
            width: 100%;
            height: 50%;
            border-top: 1px solid #000;
            display: flex;
            align-items: stretch;
            justify-content: stretch;
        }
        /* Upper columns */
        .upper-col1 {
            width: 20%;
            height: 100%;
            border-right: 1px solid #000;
            display: flex;
            flex-direction: column;
        }
        .upper-col1-segment {
            width: 100%;
            border-bottom: 1px solid #000;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1em;
        }
        .class-choice { height: 50%; }
        .level-choice { height: 15%; }
        .stat-counter { height: 15%; }
        .trait-counter { height: 15%; border-bottom: none; }
        .upper-dynamic-cell {
            width: 80%;
            height: 100%;
            border-left: 1px solid #000;
            display: flex;
        }
        .upper-col2 {
            width: 55%;
            height: 100%;
            display: flex;
            flex-direction: column;
            border-right: 1px solid #000;
        }
        .upper-col2-row1 {
            width: 100%;
            height: 69%;
            display: flex;
            border-bottom: 1px solid #000;
        }
        .upper-col2-row1-equip {
            width: 69%;
            height: 100%;
            border-right: 1px solid #000;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .upper-col2-row1-desc {
            width: 31%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .upper-col2-row2 {
            width: 100%;
            height: 29%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .upper-col3 {
            width: 25%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            border-left: 1px solid #000;
        }
        /* Lower segment */
        .stats-table-container {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1px solid #000;
        }
        .class-choice-row {
            display: flex;
            align-items: center;
            border: 1px solid #aaa;
            margin: 2px 0;
            padding: 4px;
            cursor: pointer;
            background: #222;
            color: #fff;
            transition: background 0.2s;
        }
        .class-choice-row.selected {
            background: #eaff8c;
            color: #222;
            border: 2px solid #eaff8c;
        }
        .class-choice-row img {
            width: 32px;
            height: 32px;
            margin-right: 10px;
        }
        .level-choice-inner {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        .leveltitle {
            margin-bottom: 5px;
            color: #fff;
        }
        .levelnumber {
            width: 80px;
            height: 40px;
            font-size: 1.2em;
            font-weight: bold;
            text-align: center;
            border: 1px solid #aaa;
            border-radius: 8px;
            background-color: #222;
            color: #eaff8c;
        }
        .stat-table-outer {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
        }
        .stat-container {
            display: grid;
            grid-template-columns: 120px 100px 50px 40px 40px 40px 180px 100px;
            gap: 0px;
            width: 700px;
            margin-bottom: 0px;
            border-bottom: 1px solid #333;
            margin-top: 2px;
        }
        .stat-container > div {
            padding: 1px;
            border: 0px solid black;
            text-align: center;
        }
    </style>
</head>
<body>
<div id="planner-container">
    <div class="planner-upper">
        <div class="upper-col1">
            <div class="upper-col1-segment class-choice">
                <div style="width:100%;height:100%;display:flex;flex-direction:column;justify-content:space-evenly;align-items:stretch;">
                    <div class="class-choice-row" data-class="Squire"><img src="squire.png" alt="Squire"> Squire</div>
                    <div class="class-choice-row" data-class="Knight"><img src="knight.png" alt="Knight"> Knight</div>
                    <div class="class-choice-row" data-class="Rogue"><img src="rogue.png" alt="Rogue"> Rogue</div>
                    <div class="class-choice-row" data-class="Mage"><img src="mage.png" alt="Mage"> Mage</div>
                </div>
            </div>
            <div class="upper-col1-segment level-choice">
                <div class="level-choice-inner">
                    <label class="leveltitle" for="level-input">Character Level:</label>
                    <input class="levelnumber" type="number" id="level-input" min="1" max="100" value="1">
                </div>
            </div>
            <div class="upper-col1-segment stat-counter">Stat Counter</div>
            <div class="upper-col1-segment trait-counter">Trait Counter</div>
        </div>
        <div class="upper-dynamic-cell">
            <div id="upper-dynamic-content" style="width: 100%; height: 100%; display: flex; flex-direction: row;">
                <div class="upper-col2">
                    <div class="upper-col2-row1">
                        <div class="upper-col2-row1-equip">Equipment Grid</div>
                        <div class="upper-col2-row1-desc">Description</div>
                    </div>
                    <div class="upper-col2-row2">Big Cell</div>
                </div>
                <div class="upper-col3">Item Picker</div>
            </div>
        </div>
    </div>
    <div class="planner-lower">
        <div class="stats-table-container" id="stats-table-container">
            <!-- Stats table will be generated here by JS -->asdasd
        </div>
    </div>
</div>
<script>
        // --- Class selection logic ---
        const classRows = [
            { name: "Squire", icon: "squire.png" },
            { name: "Knight", icon: "knight.png" },
            { name: "Rogue", icon: "rogue.png" },
            { name: "Mage", icon: "mage.png" }
        ];
        let selectedClass = null;
        let selectedLevel = 1;
        window.addEventListener('DOMContentLoaded', function() {
            // Make class rows selectable
            document.querySelectorAll('.class-choice-row').forEach(row => {
                row.addEventListener('click', function() {
                    document.querySelectorAll('.class-choice-row').forEach(r => r.classList.remove('selected'));
                    this.classList.add('selected');
                    selectedClass = this.getAttribute('data-class');
                    updateDebug();
                });
            });
            // Level input
            const levelInput = document.getElementById('level-input');
            levelInput.addEventListener('input', function() {
                let val = parseInt(this.value) || 1;
                if(val < 1) val = 1;
                if(val > 100) val = 100;
                this.value = val;
                selectedLevel = val;
                updateDebug();
            });
            // Set default selection
            document.querySelector('.class-choice-row[data-class="Squire"]').click();
        });
        function updateDebug() {
            document.getElementById('stats-table-container').innerText =
                `Selected class: ${selectedClass || ''}\nLevel: ${selectedLevel}`;
        }
    </script>
<script>
// --- Stat Table Logic ---
const statList = [
    "Health", "Mana", "Magic", "Damage", "Movespeed", "Ability", "Attack Speed", "HP Regen", "MP Regen", "Range", "Armor", "Defense", "Capacity"
];
let addedPoints = {};
statList.forEach(stat => addedPoints[stat] = 0);
let availablePoints = 0;

const allocatableStats = [
    "Health", "Mana", "Magic", "Ability", "HP Regen", "MP Regen", "Capacity"
];

// Class multipliers for each stat and class
const classMultipliers = {
    Squire:    { Health: 1.00, Mana: 1.00, Magic: 1.00, Damage: 1.00, Movespeed: 1.00, Ability: 1.00, "Attack Speed": 1.00, "HP Regen": 1.00, "MP Regen": 1.00, Range: 1.00, Armor: 1.00, Defense: 1.00, Capacity: 1.00 },
    Knight:    { Health: 2.00, Mana: 0.50, Magic: 0.50, Damage: 1.00, Movespeed: 1.00, Ability: 1.25, "Attack Speed": 1.00, "HP Regen": 1.25, "MP Regen": 0.50, Range: 0.50, Armor: 1.50, Defense: 1.50, Capacity: 1.50 },
    Rogue:     { Health: 1.00, Mana: 1.25, Magic: 1.50, Damage: 1.00, Movespeed: 1.00, Ability: 1.50, "Attack Speed": 1.25, "HP Regen": 1.00, "MP Regen": 1.00, Range: 1.00, Armor: 1.00, Defense: 1.00, Capacity: 1.00 },
    Mage:      { Health: 0.75, Mana: 2.00, Magic: 2.00, Damage: 1.00, Movespeed: 1.00, Ability: 0.75, "Attack Speed": 1.00, "HP Regen": 0.75, "MP Regen": 2.00, Range: 1.00, Armor: 0.75, Defense: 0.75, Capacity: 0.75 }
};
// Point value for each allocatable stat
const pointValues = {
    Health: 5,
    Mana: 5,
    Magic: 1,
    Ability: 1,
    "HP Regen": 0.2,
    "MP Regen": 0.2,
    Capacity: 10
};
// Global stat data structure
const statData = {
    Health:      { base: 150, statBonus: 0, itemBonus: 0, traitBonus: 0, final: 150 },
    Mana:        { base: 15,  statBonus: 0, itemBonus: 0, traitBonus: 0, final: 15 },
    Magic:       { base: 0,   statBonus: 0, itemBonus: 0, traitBonus: 0, final: 0 },
    Damage:      { base: 0,   statBonus: 0, itemBonus: 0, traitBonus: 0, final: 0 },
    Movespeed:   { base: 35,  statBonus: 0, itemBonus: 0, traitBonus: 0, final: 35 },
    Ability:     { base: 0,   statBonus: 0, itemBonus: 0, traitBonus: 0, final: 0 },
    "Attack Speed": { base: 10,  statBonus: 0, itemBonus: 0, traitBonus: 0, final: 10 },
    "HP Regen":     { base: 1,   statBonus: 0, itemBonus: 0, traitBonus: 0, final: 1 },
    "MP Regen":     { base: 1,   statBonus: 0, itemBonus: 0, traitBonus: 0, final: 1 },
    Range:       { base: 15,  statBonus: 0, itemBonus: 0, traitBonus: 0, final: 15 },
    Armor:       { base: 0,   statBonus: 0, itemBonus: 0, traitBonus: 0, final: 0 },
    Defense:     { base: 0,   statBonus: 0, itemBonus: 0, traitBonus: 0, final: 0 },
    Capacity:    { base: 225, statBonus: 0, itemBonus: 0, traitBonus: 0, final: 225 }
};

// Define baseValues for each stat (used in updateStatTable)
const baseValues = {
    Health: 150,
    Mana: 15,
    Magic: 0,
    Damage: 0,
    Movespeed: 35,
    Ability: 0,
    "Attack Speed": 10,
    "HP Regen": 1,
    "MP Regen": 1,
    Range: 15,
    Armor: 0,
    Defense: 0,
    Capacity: 225
};

function updateStatData() {
    // Update statBonus from allocated points
    statData.Health.statBonus = addedPoints["Health"] * 5;
    statData.Mana.statBonus = addedPoints["Mana"] * 5;
    statData.Magic.statBonus = addedPoints["Magic"] * 1;
    statData.Ability.statBonus = addedPoints["Ability"] * 1;
    statData["HP Regen"].statBonus = addedPoints["HP Regen"] * 0.2;
    statData["MP Regen"].statBonus = addedPoints["MP Regen"] * 0.2;
    statData.Capacity.statBonus = addedPoints["Capacity"] * 10;
    // Other stats get 0 from stat allocation
    statData.Damage.statBonus = 0;
    statData.Movespeed.statBonus = 0;
    statData["Attack Speed"].statBonus = 0;
    statData.Range.statBonus = 0;
    statData.Armor.statBonus = 0;
    statData.Defense.statBonus = 0;
    // Item and trait bonuses can be set elsewhere
    // Calculate final values (with class multiplier)
    const currentClass = selectedClass || "Squire";
    for (let stat in statData) {
        const mult = classMultipliers[currentClass][stat] || 1;
        statData[stat].final = (
            statData[stat].base +
            statData[stat].statBonus +
            statData[stat].itemBonus +
            statData[stat].traitBonus
        ) * mult;
    }
}
// Example dependent stat calculation
function getBowDamage() {
    // Example: Bow Damage = Damage.final * 1.5 + Attack Speed.final * 0.5
    return statData.Damage.final * 1.5 + statData["Attack Speed"].final * 0.5;
}
function getDPS() {
    // Example: DPS = Damage.final / Attack Speed.final
    return statData["Attack Speed"].final !== 0 ? (statData.Damage.final / statData["Attack Speed"].final) : 0;
}
// In updateStatTable, call updateStatData() before rendering
function updateStatTable() {
    const level = selectedLevel;
    const totalStatPoints = (level - 1) * 3;
    let usedPoints = 0;
    statList.forEach(stat => usedPoints += addedPoints[stat]);
    availablePoints = totalStatPoints - usedPoints;
    // Update stat counter cell
    document.querySelector('.stat-counter').innerHTML =
        `<div style='width:100%;text-align:center;'>Available: <span id='available-points'>${availablePoints}</span><br>Total: <span id='total-points'>${totalStatPoints}</span></div>`;
    // Build stat table (manual rows for each stat)
    let html = `<div class=\"stat-table-outer\">`;
    html += `<div class=\"stat-container\">
        <div>Stat</div>
        <div>Class Multiplier</div>
        <div>Base</div>
        <div>-</div>
        <div>+</div>
        <div>Pts</div>
        <div style='min-width:120px;'>Calculation</div>
        <div>Final Value</div>
    </div>`;
    const currentClass = selectedClass || "Squire";
    // Health
    html += buildStatRow("Health", baseValues["Health"], currentClass);
    // Mana
    html += buildStatRow("Mana", baseValues["Mana"], currentClass);
    // Magic
    html += buildStatRow("Magic", baseValues["Magic"], currentClass);
    // Damage
    html += buildStatRow("Damage", baseValues["Damage"], currentClass);
    // Bow Damage
    html += buildStatRow("Bow Damage", 0, currentClass);
    // Movespeed
    html += buildStatRow("Movespeed", baseValues["Movespeed"], currentClass);
    // Ability
    html += buildStatRow("Ability", baseValues["Ability"], currentClass);
    // Attack Speed
    html += buildStatRow("Attack Speed", baseValues["Attack Speed"], currentClass);
    // HP Regen
    html += buildStatRow("HP Regen", baseValues["HP Regen"], currentClass);
    // MP Regen
    html += buildStatRow("MP Regen", baseValues["MP Regen"], currentClass);
    // Range
    html += buildStatRow("Range", baseValues["Range"], currentClass);
    // Armor
    html += buildStatRow("Armor", baseValues["Armor"], currentClass);
    // Defense
    html += buildStatRow("Defense", baseValues["Defense"], currentClass);
    // Capacity
    html += buildStatRow("Capacity", baseValues["Capacity"], currentClass);
    html += `</div>`;
    document.getElementById('stats-table-container').innerHTML = html;
}
function buildStatRow(stat, baseValue, currentClass) {
    let added = addedPoints[stat];
    let canAllocate = false;
    let classMult = 1;
    let pointVal = 0;
    let calc = '';
    let finalVal = 0;
    switch(stat){
        case "Bow Damage":
            classMult = 0;
            baseValue = "";
            added = "";
            calc = "BOW DAMAGE!";
            //get final value of Damage and Attack Speed;
            // This is a placeholder, actual calculation logic would go here
            finalVal = 0;
            break;
        case "DPS":
            classMult = 0;
            baseValue = "";
            added = "";
            calc = "DPS!";
            //get final value of Damage/(Attack Speed/10);
            // This is a placeholder, actual calculation logic would go here
            finalVal = 0;
            break;
        default:
            canAllocate = allocatableStats.includes(stat);
            classMult = classMultipliers[currentClass][stat] || 1;
            pointVal = pointValues[stat] || 0;
            calc = `${baseValue}`;
            if (canAllocate && added > 0) calc += ` + (${added} x ${pointVal})`;
            finalVal = baseValue;
            if (canAllocate) finalVal += added * pointVal;
            finalVal = (finalVal * classMult).toFixed(2);
            break;
    }
    return `<div class=\"stat-container\">
        <div>${stat}</div>
        <div>${(classMult * 100).toFixed(0)}%</div>
        <div>${baseValue}</div>
        <div>${canAllocate && added > 0 ? `<button onclick='subtractPoint(\"${stat}\")'>-</button>` : ''}</div>
        <div>${canAllocate && (availablePoints > 0 && added < selectedLevel) ? `<button onclick='addPoint(\"${stat}\")'>+</button>` : ''}</div>
        <div>${added}</div>
        <div>${calc}</div>
        <div>${finalVal}</div>
    </div>`;
}
// Hook stat table update to level and class selection
(function() {
    const origUpdateDebug = window.updateDebug;
    window.updateDebug = function() {
        if(origUpdateDebug) origUpdateDebug();
        updateStatTable();
    };
})();
window.addEventListener('DOMContentLoaded', updateStatTable);
function addPoint(stat) {
    const level = selectedLevel;
    if (availablePoints > 0 && addedPoints[stat] < level) {
        addedPoints[stat]++;
        updateStatTable();
    }
}
function subtractPoint(stat) {
    if (addedPoints[stat] > 0) {
        addedPoints[stat]--;
        updateStatTable();
    }
}
</script>
</body>
</html>
